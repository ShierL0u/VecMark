nohup: ignoring input
/root/autodl-tmp/vectormark/utils1.py:17: LangChainDeprecationWarning: As of langchain-core 0.3.0, LangChain uses pydantic v2 internally. The langchain_core.pydantic_v1 module was a compatibility shim for pydantic v1, and should no longer be used. Please update the code to import from Pydantic directly.

For example, replace imports like: `from langchain_core.pydantic_v1 import BaseModel`
with: `from pydantic import BaseModel`
or the v1 compatibility namespace if you are working in a code base that has not been fully upgraded to pydantic 2 yet. 	from pydantic.v1 import BaseModel

  from KGW.KGW_claude import KGWWatermarkedLLM
Loading model: ../model/Qwen/Qwen2.5-32B-Instruct-GPTQ-Int8

[32mINFO[0m  ENV: Auto setting CUDA_DEVICE_ORDER=PCI_BUS_ID for correctness.          
[32mINFO[0m   Kernel: Auto-selection: adding candidate `TritonV2QuantLinear`          
`loss_type=None` was set in the config but it is unrecognised.Using the default loss: `ForCausalLMLoss`.
INFO:accelerate.utils.modeling:We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|          | 0/9 [00:00<?, ?it/s]Loading checkpoint shards:  11%|█         | 1/9 [00:00<00:06,  1.16it/s]Loading checkpoint shards:  22%|██▏       | 2/9 [00:01<00:05,  1.27it/s]Loading checkpoint shards:  33%|███▎      | 3/9 [00:02<00:04,  1.31it/s]Loading checkpoint shards:  44%|████▍     | 4/9 [00:03<00:03,  1.32it/s]Loading checkpoint shards:  56%|█████▌    | 5/9 [00:03<00:03,  1.29it/s]Loading checkpoint shards:  67%|██████▋   | 6/9 [00:04<00:02,  1.30it/s]Loading checkpoint shards:  78%|███████▊  | 7/9 [00:05<00:01,  1.32it/s]Loading checkpoint shards:  89%|████████▉ | 8/9 [00:06<00:00,  1.33it/s]Loading checkpoint shards: 100%|██████████| 9/9 [00:06<00:00,  1.36it/s]Loading checkpoint shards: 100%|██████████| 9/9 [00:06<00:00,  1.32it/s]
[32mINFO[0m  Format: Converting `checkpoint_format` from `gptq` to internal `gptq_v2`.
[32mINFO[0m  Format: Converting GPTQ v1 to v2                                         
[32mINFO[0m  Format: Conversion complete: 0.015778064727783203s                       
[32mINFO[0m  Optimize: `TritonV2QuantLinear` compilation triggered.                   
Token indices sequence length is longer than the specified maximum sequence length for this model (1217491 > 131072). Running this sequence through the model will result in indexing errors
Model loaded successfully
Column text has 3633 rows, max token length: 2300
Column text has 3633 rows, min token length: 15
Original max tokens: 2300
Original min tokens: 15
Compute ppl:   0%|          | 0/81167 [00:00<?, ?it/s]Compute ppl:   0%|          | 1/81167 [00:00<16:52:17,  1.34it/s]Compute ppl:   0%|          | 2/81167 [00:00<8:36:33,  2.62it/s] Compute ppl:   0%|          | 3/81167 [00:01<6:27:20,  3.49it/s]Compute ppl:   0%|          | 4/81167 [00:01<5:27:01,  4.14it/s]Compute ppl:   0%|          | 5/81167 [00:01<4:52:55,  4.62it/s]Compute ppl:   0%|          | 6/81167 [00:01<4:32:42,  4.96it/s]Compute ppl:   0%|          | 7/81167 [00:01<4:19:53,  5.20it/s]Compute ppl:   0%|          | 8/81167 [00:01<4:11:29,  5.38it/s]Compute ppl:   0%|          | 9/81167 [00:02<4:05:51,  5.50it/s]Compute ppl:   0%|          | 10/81167 [00:02<4:02:06,  5.59it/s]Compute ppl:   0%|          | 11/81167 [00:02<3:59:28,  5.65it/s]Compute ppl:   0%|          | 12/81167 [00:02<3:57:39,  5.69it/s]Compute ppl:   0%|          | 13/81167 [00:02<3:56:22,  5.72it/s]Compute ppl:   0%|          | 14/81167 [00:02<3:55:31,  5.74it/s]Compute ppl:   0%|          | 15/81167 [00:03<3:54:51,  5.76it/s]Compute ppl:   0%|          | 16/81167 [00:03<3:54:27,  5.77it/s]Compute ppl:   0%|          | 17/81167 [00:03<3:54:14,  5.77it/s]Compute ppl:   0%|          | 18/81167 [00:03<3:53:57,  5.78it/s]Compute ppl:   0%|          | 19/81167 [00:03<3:53:48,  5.78it/s]Compute ppl:   0%|          | 20/81167 [00:03<3:53:43,  5.79it/s]Compute ppl:   0%|          | 21/81167 [00:04<3:53:40,  5.79it/s]Compute ppl:   0%|          | 22/81167 [00:04<3:53:37,  5.79it/s]Compute ppl:   0%|          | 23/81167 [00:04<3:53:37,  5.79it/s]Compute ppl:   0%|          | 24/81167 [00:04<3:53:35,  5.79it/s]Compute ppl:   0%|          | 25/81167 [00:04<3:53:36,  5.79it/s]Compute ppl:   0%|          | 26/81167 [00:05<3:53:32,  5.79it/s]Compute ppl:   0%|          | 27/81167 [00:05<3:53:32,  5.79it/s]Compute ppl:   0%|          | 28/81167 [00:05<3:53:32,  5.79it/s]Compute ppl:   0%|          | 29/81167 [00:05<3:53:33,  5.79it/s]Compute ppl:   0%|          | 30/81167 [00:05<3:53:32,  5.79it/s]Compute ppl:   0%|          | 31/81167 [00:05<3:53:32,  5.79it/s]Compute ppl:   0%|          | 32/81167 [00:06<3:53:32,  5.79it/s]Compute ppl:   0%|          | 33/81167 [00:06<3:53:31,  5.79it/s]Compute ppl:   0%|          | 34/81167 [00:06<3:53:31,  5.79it/s]Compute ppl:   0%|          | 35/81167 [00:06<3:53:31,  5.79it/s]Compute ppl:   0%|          | 36/81167 [00:06<3:53:31,  5.79it/s]Compute ppl:   0%|          | 37/81167 [00:06<3:53:30,  5.79it/s]Compute ppl:   0%|          | 38/81167 [00:07<3:53:32,  5.79it/s]Compute ppl:   0%|          | 39/81167 [00:07<3:53:35,  5.79it/s]Compute ppl:   0%|          | 40/81167 [00:07<3:53:32,  5.79it/s]Compute ppl:   0%|          | 41/81167 [00:07<3:53:32,  5.79it/s]Compute ppl:   0%|          | 42/81167 [00:07<3:53:32,  5.79it/s]Compute ppl:   0%|          | 43/81167 [00:07<3:53:29,  5.79it/s]Compute ppl:   0%|          | 44/81167 [00:08<3:53:28,  5.79it/s]Compute ppl:   0%|          | 45/81167 [00:08<3:53:29,  5.79it/s]Compute ppl:   0%|          | 46/81167 [00:08<3:53:29,  5.79it/s]Compute ppl:   0%|          | 47/81167 [00:08<3:53:29,  5.79it/s]Compute ppl:   0%|          | 48/81167 [00:08<3:53:28,  5.79it/s]Compute ppl:   0%|          | 49/81167 [00:08<3:53:28,  5.79it/s]Compute ppl:   0%|          | 50/81167 [00:09<3:53:28,  5.79it/s]Compute ppl:   0%|          | 51/81167 [00:09<3:53:28,  5.79it/s]Compute ppl:   0%|          | 52/81167 [00:09<3:53:29,  5.79it/s]Compute ppl:   0%|          | 53/81167 [00:09<3:53:29,  5.79it/s]Compute ppl:   0%|          | 54/81167 [00:09<3:53:30,  5.79it/s]Compute ppl:   0%|          | 55/81167 [00:10<3:53:28,  5.79it/s]Compute ppl:   0%|          | 56/81167 [00:10<3:53:29,  5.79it/s]Compute ppl:   0%|          | 57/81167 [00:10<3:53:27,  5.79it/s]Compute ppl:   0%|          | 58/81167 [00:10<3:53:27,  5.79it/s]Compute ppl:   0%|          | 59/81167 [00:10<3:53:27,  5.79it/s]Compute ppl:   0%|          | 60/81167 [00:10<3:53:28,  5.79it/s]Compute ppl:   0%|          | 61/81167 [00:11<3:53:27,  5.79it/s]Compute ppl:   0%|          | 62/81167 [00:11<3:53:27,  5.79it/s]Compute ppl:   0%|          | 63/81167 [00:11<3:53:27,  5.79it/s]Compute ppl:   0%|          | 64/81167 [00:11<3:53:28,  5.79it/s]Compute ppl:   0%|          | 65/81167 [00:11<3:53:27,  5.79it/s]Compute ppl:   0%|          | 66/81167 [00:11<3:53:26,  5.79it/s]Compute ppl:   0%|          | 67/81167 [00:12<3:53:26,  5.79it/s]Compute ppl:   0%|          | 68/81167 [00:12<3:53:31,  5.79it/s]Compute ppl:   0%|          | 69/81167 [00:12<3:53:29,  5.79it/s]Compute ppl:   0%|          | 70/81167 [00:12<3:53:28,  5.79it/s]Compute ppl:   0%|          | 71/81167 [00:12<3:53:27,  5.79it/s]Compute ppl:   0%|          | 72/81167 [00:12<3:53:26,  5.79it/s]Compute ppl:   0%|          | 73/81167 [00:13<3:53:27,  5.79it/s]Compute ppl:   0%|          | 74/81167 [00:13<3:53:27,  5.79it/s]Compute ppl:   0%|          | 75/81167 [00:13<3:53:28,  5.79it/s]Compute ppl:   0%|          | 76/81167 [00:13<3:53:28,  5.79it/s]Compute ppl:   0%|          | 77/81167 [00:13<3:53:28,  5.79it/s]Compute ppl:   0%|          | 78/81167 [00:13<3:53:28,  5.79it/s]Compute ppl:   0%|          | 79/81167 [00:14<3:53:27,  5.79it/s]Compute ppl:   0%|          | 80/81167 [00:14<3:53:27,  5.79it/s]Compute ppl:   0%|          | 81/81167 [00:14<3:53:27,  5.79it/s]Compute ppl:   0%|          | 82/81167 [00:14<3:53:27,  5.79it/s]Compute ppl:   0%|          | 83/81167 [00:14<3:53:27,  5.79it/s]Compute ppl:   0%|          | 84/81167 [00:15<3:53:26,  5.79it/s]Compute ppl:   0%|          | 85/81167 [00:15<3:53:25,  5.79it/s]Compute ppl:   0%|          | 86/81167 [00:15<3:53:25,  5.79it/s]Compute ppl:   0%|          | 87/81167 [00:15<3:53:26,  5.79it/s]Compute ppl:   0%|          | 88/81167 [00:15<3:53:26,  5.79it/s]Compute ppl:   0%|          | 89/81167 [00:15<3:53:27,  5.79it/s]Compute ppl:   0%|          | 90/81167 [00:16<3:53:27,  5.79it/s]Compute ppl:   0%|          | 91/81167 [00:16<3:53:26,  5.79it/s]Compute ppl:   0%|          | 92/81167 [00:16<3:53:27,  5.79it/s]Compute ppl:   0%|          | 93/81167 [00:16<3:53:27,  5.79it/s]Compute ppl:   0%|          | 94/81167 [00:16<3:53:27,  5.79it/s]Compute ppl:   0%|          | 95/81167 [00:16<3:53:26,  5.79it/s]Compute ppl:   0%|          | 96/81167 [00:17<3:53:25,  5.79it/s]Compute ppl:   0%|          | 97/81167 [00:17<3:53:29,  5.79it/s]Compute ppl:   0%|          | 98/81167 [00:17<3:53:27,  5.79it/s]Compute ppl:   0%|          | 99/81167 [00:17<3:53:28,  5.79it/s]Compute ppl:   0%|          | 100/81167 [00:17<3:53:23,  5.79it/s]Compute ppl:   0%|          | 101/81167 [00:17<3:53:23,  5.79it/s]Compute ppl:   0%|          | 102/81167 [00:18<3:53:22,  5.79it/s]Compute ppl:   0%|          | 103/81167 [00:18<3:53:22,  5.79it/s]Compute ppl:   0%|          | 104/81167 [00:18<3:53:22,  5.79it/s]Compute ppl:   0%|          | 105/81167 [00:18<3:53:22,  5.79it/s]Compute ppl:   0%|          | 106/81167 [00:18<3:53:23,  5.79it/s]Compute ppl:   0%|          | 107/81167 [00:19<3:53:22,  5.79it/s]Compute ppl:   0%|          | 108/81167 [00:19<3:53:21,  5.79it/s]Compute ppl:   0%|          | 109/81167 [00:19<3:53:22,  5.79it/s]Compute ppl:   0%|          | 110/81167 [00:19<3:53:21,  5.79it/s]Compute ppl:   0%|          | 111/81167 [00:19<3:53:21,  5.79it/s]Compute ppl:   0%|          | 112/81167 [00:19<3:53:20,  5.79it/s]Compute ppl:   0%|          | 113/81167 [00:20<3:53:20,  5.79it/s]Compute ppl:   0%|          | 114/81167 [00:20<3:53:20,  5.79it/s]Compute ppl:   0%|          | 115/81167 [00:20<3:53:19,  5.79it/s]Compute ppl:   0%|          | 116/81167 [00:20<3:53:20,  5.79it/s]Compute ppl:   0%|          | 117/81167 [00:20<3:53:20,  5.79it/s]Compute ppl:   0%|          | 118/81167 [00:20<3:53:21,  5.79it/s]Compute ppl:   0%|          | 119/81167 [00:21<3:53:21,  5.79it/s]Compute ppl:   0%|          | 120/81167 [00:21<3:53:21,  5.79it/s]Compute ppl:   0%|          | 121/81167 [00:21<3:53:20,  5.79it/s]Compute ppl:   0%|          | 122/81167 [00:21<3:53:19,  5.79it/s]Compute ppl:   0%|          | 123/81167 [00:21<3:53:19,  5.79it/s]Compute ppl:   0%|          | 124/81167 [00:21<3:53:21,  5.79it/s]Compute ppl:   0%|          | 125/81167 [00:22<3:53:18,  5.79it/s]Compute ppl:   0%|          | 126/81167 [00:22<3:53:24,  5.79it/s]Compute ppl:   0%|          | 127/81167 [00:22<3:53:20,  5.79it/s]Compute ppl:   0%|          | 128/81167 [00:22<3:53:17,  5.79it/s]Compute ppl:   0%|          | 129/81167 [00:22<3:53:21,  5.79it/s]Compute ppl:   0%|          | 130/81167 [00:22<3:53:18,  5.79it/s]Compute ppl:   0%|          | 131/81167 [00:23<3:53:18,  5.79it/s]Compute ppl:   0%|          | 132/81167 [00:23<3:53:18,  5.79it/s]Compute ppl:   0%|          | 133/81167 [00:23<3:53:18,  5.79it/s]Compute ppl:   0%|          | 134/81167 [00:23<3:53:16,  5.79it/s]Compute ppl:   0%|          | 135/81167 [00:23<3:53:16,  5.79it/s]Compute ppl:   0%|          | 136/81167 [00:24<3:53:16,  5.79it/s]Compute ppl:   0%|          | 137/81167 [00:24<3:53:17,  5.79it/s]Compute ppl:   0%|          | 138/81167 [00:24<3:53:18,  5.79it/s]Compute ppl:   0%|          | 139/81167 [00:24<3:53:14,  5.79it/s]Compute ppl:   0%|          | 140/81167 [00:24<3:53:35,  5.78it/s]Compute ppl:   0%|          | 141/81167 [00:24<3:53:09,  5.79it/s]Compute ppl:   0%|          | 142/81167 [00:25<3:53:11,  5.79it/s]