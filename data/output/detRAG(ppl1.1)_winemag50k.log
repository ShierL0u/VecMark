nohup: ignoring input
/root/autodl-tmp/vectormark/utils1.py:17: LangChainDeprecationWarning: As of langchain-core 0.3.0, LangChain uses pydantic v2 internally. The langchain_core.pydantic_v1 module was a compatibility shim for pydantic v1, and should no longer be used. Please update the code to import from Pydantic directly.

For example, replace imports like: `from langchain_core.pydantic_v1 import BaseModel`
with: `from pydantic import BaseModel`
or the v1 compatibility namespace if you are working in a code base that has not been fully upgraded to pydantic 2 yet. 	from pydantic.v1 import BaseModel

  from KGW.KGW_claude import KGWWatermarkedLLM
Loading model: ../model/Qwen/Qwen2.5-32B-Instruct-GPTQ-Int8

[32mINFO[0m  ENV: Auto setting CUDA_DEVICE_ORDER=PCI_BUS_ID for correctness.          
[32mINFO[0m   Kernel: Auto-selection: adding candidate `TritonV2QuantLinear`          
`loss_type=None` was set in the config but it is unrecognised.Using the default loss: `ForCausalLMLoss`.
INFO:accelerate.utils.modeling:We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|          | 0/9 [00:00<?, ?it/s]Loading checkpoint shards:  11%|█         | 1/9 [00:00<00:06,  1.17it/s]Loading checkpoint shards:  22%|██▏       | 2/9 [00:01<00:05,  1.29it/s]Loading checkpoint shards:  33%|███▎      | 3/9 [00:02<00:04,  1.33it/s]Loading checkpoint shards:  44%|████▍     | 4/9 [00:03<00:03,  1.36it/s]Loading checkpoint shards:  56%|█████▌    | 5/9 [00:03<00:02,  1.36it/s]Loading checkpoint shards:  67%|██████▋   | 6/9 [00:04<00:02,  1.36it/s]Loading checkpoint shards:  78%|███████▊  | 7/9 [00:05<00:01,  1.37it/s]Loading checkpoint shards:  89%|████████▉ | 8/9 [00:05<00:00,  1.36it/s]Loading checkpoint shards: 100%|██████████| 9/9 [00:06<00:00,  1.38it/s]Loading checkpoint shards: 100%|██████████| 9/9 [00:06<00:00,  1.35it/s]
[32mINFO[0m  Format: Converting `checkpoint_format` from `gptq` to internal `gptq_v2`.
[32mINFO[0m  Format: Converting GPTQ v1 to v2                                         
[32mINFO[0m  Format: Conversion complete: 0.015769243240356445s                       
[32mINFO[0m  Optimize: `TritonV2QuantLinear` compilation triggered.                   
Model loaded successfully
Column description has 50000 rows, max token length: 167
Column description has 50000 rows, min token length: 8
Original max tokens: 167
Original min tokens: 8
Original PPL: 100   |   PPL Threshold: 110.00000000000001
answer generate:   0%|          | 0/127 [00:00<?, ?it/s]answer generate:   1%|          | 1/127 [00:02<05:43,  2.73s/it]answer generate:   2%|▏         | 2/127 [00:04<04:58,  2.39s/it]answer generate:   2%|▏         | 3/127 [00:07<04:43,  2.28s/it]answer generate:   3%|▎         | 4/127 [00:09<04:34,  2.23s/it]answer generate:   4%|▍         | 5/127 [00:11<04:29,  2.21s/it]answer generate:   5%|▍         | 6/127 [00:13<04:25,  2.20s/it]answer generate:   6%|▌         | 7/127 [00:15<04:22,  2.19s/it]answer generate:   6%|▋         | 8/127 [00:17<04:20,  2.19s/it]answer generate:   7%|▋         | 9/127 [00:20<04:17,  2.18s/it]answer generate:   8%|▊         | 10/127 [00:22<04:15,  2.19s/it]answer generate:   9%|▊         | 11/127 [00:24<04:13,  2.19s/it]answer generate:   9%|▉         | 12/127 [00:26<04:11,  2.19s/it]answer generate:  10%|█         | 13/127 [00:28<04:09,  2.19s/it]answer generate:  11%|█         | 14/127 [00:31<04:07,  2.19s/it]answer generate:  12%|█▏        | 15/127 [00:33<04:05,  2.19s/it]answer generate:  13%|█▎        | 16/127 [00:35<04:03,  2.20s/it]answer generate:  13%|█▎        | 17/127 [00:37<04:01,  2.20s/it]answer generate:  14%|█▍        | 18/127 [00:39<03:59,  2.20s/it]answer generate:  15%|█▍        | 19/127 [00:42<03:57,  2.20s/it]answer generate:  16%|█▌        | 20/127 [00:44<03:55,  2.20s/it]answer generate:  17%|█▋        | 21/127 [00:46<03:53,  2.20s/it]answer generate:  17%|█▋        | 22/127 [00:48<03:51,  2.20s/it]answer generate:  18%|█▊        | 23/127 [00:50<03:49,  2.20s/it]answer generate:  19%|█▉        | 24/127 [00:53<03:47,  2.21s/it]answer generate:  20%|█▉        | 25/127 [00:55<03:45,  2.21s/it]answer generate:  20%|██        | 26/127 [00:57<03:43,  2.21s/it]answer generate:  21%|██▏       | 27/127 [00:59<03:41,  2.21s/it]answer generate:  22%|██▏       | 28/127 [01:01<03:38,  2.21s/it]answer generate:  23%|██▎       | 29/127 [01:04<03:36,  2.21s/it]answer generate:  24%|██▎       | 30/127 [01:06<03:34,  2.21s/it]answer generate:  24%|██▍       | 31/127 [01:08<03:32,  2.22s/it]answer generate:  25%|██▌       | 32/127 [01:10<03:30,  2.22s/it]answer generate:  26%|██▌       | 33/127 [01:12<03:28,  2.22s/it]answer generate:  27%|██▋       | 34/127 [01:15<03:26,  2.22s/it]answer generate:  28%|██▊       | 35/127 [01:17<03:24,  2.22s/it]answer generate:  28%|██▊       | 36/127 [01:19<03:21,  2.22s/it]answer generate:  29%|██▉       | 37/127 [01:21<03:19,  2.22s/it]answer generate:  30%|██▉       | 38/127 [01:24<03:17,  2.22s/it]answer generate:  31%|███       | 39/127 [01:26<03:15,  2.22s/it]answer generate:  31%|███▏      | 40/127 [01:28<03:13,  2.22s/it]answer generate:  32%|███▏      | 41/127 [01:30<03:11,  2.22s/it]answer generate:  33%|███▎      | 42/127 [01:32<03:08,  2.22s/it]answer generate:  34%|███▍      | 43/127 [01:35<03:06,  2.22s/it]answer generate:  35%|███▍      | 44/127 [01:37<03:04,  2.22s/it]answer generate:  35%|███▌      | 45/127 [01:39<03:02,  2.22s/it]answer generate:  36%|███▌      | 46/127 [01:41<03:00,  2.22s/it]answer generate:  37%|███▋      | 47/127 [01:44<02:57,  2.22s/it]answer generate:  38%|███▊      | 48/127 [01:46<02:55,  2.23s/it]answer generate:  39%|███▊      | 49/127 [01:48<02:53,  2.23s/it]answer generate:  39%|███▉      | 50/127 [01:50<02:51,  2.23s/it]answer generate:  40%|████      | 51/127 [01:53<02:49,  2.23s/it]answer generate:  41%|████      | 52/127 [01:55<02:47,  2.23s/it]answer generate:  42%|████▏     | 53/127 [01:57<02:44,  2.23s/it]answer generate:  43%|████▎     | 54/127 [01:59<02:42,  2.23s/it]answer generate:  43%|████▎     | 55/127 [02:01<02:40,  2.23s/it]answer generate:  44%|████▍     | 56/127 [02:04<02:38,  2.23s/it]answer generate:  45%|████▍     | 57/127 [02:06<02:35,  2.23s/it]answer generate:  46%|████▌     | 58/127 [02:08<02:33,  2.23s/it]answer generate:  46%|████▋     | 59/127 [02:10<02:31,  2.23s/it]answer generate:  47%|████▋     | 60/127 [02:13<02:29,  2.23s/it]answer generate:  48%|████▊     | 61/127 [02:15<02:26,  2.23s/it]answer generate:  49%|████▉     | 62/127 [02:17<02:24,  2.23s/it]answer generate:  50%|████▉     | 63/127 [02:19<02:22,  2.23s/it]answer generate:  50%|█████     | 64/127 [02:21<02:20,  2.23s/it]answer generate:  51%|█████     | 65/127 [02:24<02:18,  2.23s/it]answer generate:  52%|█████▏    | 66/127 [02:26<02:15,  2.23s/it]answer generate:  53%|█████▎    | 67/127 [02:28<02:13,  2.23s/it]answer generate:  54%|█████▎    | 68/127 [02:30<02:11,  2.23s/it]answer generate:  54%|█████▍    | 69/127 [02:33<02:09,  2.23s/it]answer generate:  55%|█████▌    | 70/127 [02:35<02:06,  2.23s/it]answer generate:  56%|█████▌    | 71/127 [02:37<02:04,  2.23s/it]answer generate:  57%|█████▋    | 72/127 [02:39<02:02,  2.23s/it]answer generate:  57%|█████▋    | 73/127 [02:42<02:00,  2.23s/it]answer generate:  58%|█████▊    | 74/127 [02:44<01:58,  2.23s/it]answer generate:  59%|█████▉    | 75/127 [02:46<01:55,  2.23s/it]answer generate:  60%|█████▉    | 76/127 [02:48<01:53,  2.23s/it]answer generate:  61%|██████    | 77/127 [02:50<01:51,  2.23s/it]answer generate:  61%|██████▏   | 78/127 [02:53<01:49,  2.23s/it]answer generate:  62%|██████▏   | 79/127 [02:55<01:46,  2.23s/it]answer generate:  63%|██████▎   | 80/127 [02:57<01:44,  2.23s/it]answer generate:  64%|██████▍   | 81/127 [02:59<01:42,  2.23s/it]answer generate:  65%|██████▍   | 82/127 [03:02<01:40,  2.23s/it]answer generate:  65%|██████▌   | 83/127 [03:04<01:37,  2.23s/it]answer generate:  66%|██████▌   | 84/127 [03:06<01:35,  2.23s/it]answer generate:  67%|██████▋   | 85/127 [03:08<01:33,  2.23s/it]answer generate:  68%|██████▊   | 86/127 [03:10<01:31,  2.23s/it]answer generate:  69%|██████▊   | 87/127 [03:13<01:29,  2.23s/it]answer generate:  69%|██████▉   | 88/127 [03:15<01:26,  2.23s/it]answer generate:  70%|███████   | 89/127 [03:17<01:24,  2.23s/it]answer generate:  71%|███████   | 90/127 [03:19<01:22,  2.23s/it]answer generate:  72%|███████▏  | 91/127 [03:22<01:20,  2.23s/it]answer generate:  72%|███████▏  | 92/127 [03:24<01:17,  2.23s/it]answer generate:  73%|███████▎  | 93/127 [03:26<01:15,  2.23s/it]answer generate:  74%|███████▍  | 94/127 [03:28<01:13,  2.23s/it]answer generate:  75%|███████▍  | 95/127 [03:31<01:11,  2.23s/it]answer generate:  76%|███████▌  | 96/127 [03:33<01:09,  2.23s/it]answer generate:  76%|███████▋  | 97/127 [03:35<01:06,  2.23s/it]answer generate:  77%|███████▋  | 98/127 [03:37<01:04,  2.23s/it]answer generate:  78%|███████▊  | 99/127 [03:39<01:02,  2.23s/it]answer generate:  79%|███████▊  | 100/127 [03:42<01:00,  2.23s/it]answer generate:  80%|███████▉  | 101/127 [03:44<00:57,  2.23s/it]answer generate:  80%|████████  | 102/127 [03:46<00:55,  2.23s/it]answer generate:  81%|████████  | 103/127 [03:48<00:53,  2.23s/it]answer generate:  82%|████████▏ | 104/127 [03:51<00:51,  2.23s/it]answer generate:  83%|████████▎ | 105/127 [03:53<00:49,  2.23s/it]answer generate:  83%|████████▎ | 106/127 [03:55<00:46,  2.23s/it]answer generate:  84%|████████▍ | 107/127 [03:57<00:44,  2.23s/it]answer generate:  85%|████████▌ | 108/127 [03:59<00:42,  2.23s/it]answer generate:  86%|████████▌ | 109/127 [04:02<00:40,  2.23s/it]answer generate:  87%|████████▋ | 110/127 [04:04<00:37,  2.23s/it]answer generate:  87%|████████▋ | 111/127 [04:06<00:35,  2.23s/it]answer generate:  88%|████████▊ | 112/127 [04:08<00:33,  2.23s/it]answer generate:  89%|████████▉ | 113/127 [04:11<00:31,  2.23s/it]answer generate:  90%|████████▉ | 114/127 [04:13<00:28,  2.23s/it]answer generate:  91%|█████████ | 115/127 [04:15<00:26,  2.23s/it]answer generate:  91%|█████████▏| 116/127 [04:17<00:24,  2.23s/it]answer generate:  92%|█████████▏| 117/127 [04:20<00:22,  2.23s/it]answer generate:  93%|█████████▎| 118/127 [04:22<00:20,  2.23s/it]answer generate:  94%|█████████▎| 119/127 [04:24<00:17,  2.23s/it]answer generate:  94%|█████████▍| 120/127 [04:26<00:15,  2.23s/it]answer generate:  95%|█████████▌| 121/127 [04:28<00:13,  2.23s/it]answer generate:  96%|█████████▌| 122/127 [04:31<00:11,  2.23s/it]answer generate:  97%|█████████▋| 123/127 [04:33<00:08,  2.23s/it]answer generate:  98%|█████████▊| 124/127 [04:35<00:06,  2.23s/it]answer generate:  98%|█████████▊| 125/127 [04:37<00:04,  2.23s/it]answer generate:  99%|█████████▉| 126/127 [04:40<00:02,  2.23s/it]answer generate: 100%|██████████| 127/127 [04:42<00:00,  2.23s/it]answer generate: 100%|██████████| 127/127 [04:42<00:00,  2.22s/it]
total_answer: 254 | over_ppl_answer: 4
over_ppl_answer_rate: 0.015748031496062992
Done with 127 records
